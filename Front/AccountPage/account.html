<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="account.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="icon" href="../../images/logo arosage.png" type="image/png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf/notyf.min.css">
    <script src="https://cdn.jsdelivr.net/npm/notyf/notyf.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <title>Mon compte</title>
</head>
<body>
    <nav class="navbar">
        <a href="../Homepage/homepage.html" class="navbar-logo">
            <img src="../../images/logo arosage.png" alt="logo de l'app" class="logo">
        </a>
        <div class="navbar-links">
            <a href="../Homepage/homepage.html"><i class="fas fa-home"></i> Accueil</a>
            <a href="account.html"><i class="fas fa-user"></i> Compte</a>
            <a href="../ContactPage/contact.html"><i class="fas fa-envelope"></i> Contact</a>
            <a href="../LoginPage/login.html"><i class="fas fa-sign-out-alt"></i> Déconnexion</a>
        </div>
    </nav>
    <section class="base">
        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'Compte')">Mon compte</button>
            <button class="tab-button" onclick="openTab(event, 'Annonce')">Mes annonces</button>
        </div>
        <div id="Compte" class="tab-content active">
            <div id="your_profil" class="account-container">
                <div class="account-details">
                    <h2 id="your_name"></h2>
                    <p id="your_email"></p>
                    <p id="your_adresse"></p>
                    <p id="your_phone"></p>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $.ajax({
                        url: "../../Back/Account/account.php",
                        type: "GET",
                        dataType: "json",
                        success: function(res) {
                            $("#your_name").text(res.user.prenom + " " + res.user.nom);
                            $("#your_email").text(res.user.email);
                            $("#your_phone").text("0"+res.user.telephone);
                            if (res.user.adresse) {
                                $("#your_adresse").text(res.user.adresse);
                            }
                        },
                        error: function(jqXHR, textStatus, errorThrown) {
                            console.error("Erreur lors de la requête AJAX : ", textStatus, errorThrown);
                        }
                    });
                });
            </script>
            <div class="button-container">
                <button class="deco-btn" type="submit" id="logout_button">DECONNEXION</button>
            </div>
        </div>
        <div id="Annonce" class="tab-content">
            <div id="annoncesContainer"></div>
            <div id="no-annonces-message" style="display: none;">Vous n'avez pas posté d'annonces.</div>
            <div id="your_annonce">
                <h3 id="annonce_title"></h3>
                <p id="adresse"></p>
            </div>
            <script>
                $(document).ready(function() {
                    $.ajax({
                        url: "../../Back/plantes.php",
                        type: "GET",
                        dataType: "json",
                        data: {
                            opt: "select_id"
                        },
                        success: function(res) {
                            if (res.plantes && res.plantes.length > 0) {
                                for (let i = 0; i < res.plantes.length; i++) {
                                    const name_plante = $("<h3></h3>").text(res.plantes[i].name_plante);
                                    const img_plante = $("<img>").attr("src","../../images/Rose.jpg");
                                    if (res.plantes[i].name_plante == "Cactus"){
                                        img_plante.attr("src","../../images/cactus.jpg");
                                    } else if (res.plantes[i].name_plante == "Lilla"){
                                        img_plante.attr("src","../../images/lilla.jpg");
                                    } else if (res.plantes[i].name_plante == "Pissenli"){
                                        img_plante.attr("src","../../images/pissenli.jpg");
                                    } else if (res.plantes[i].name_plante == "Rose") {
                                        img_plante.attr("src","../../images/Rose.jpg");
                                    }
                                    const loc = $("<p></p>").text(res.plantes[i].localisation);
                                    $("#your_annonce").append(name_plante, img_plante, loc);
                                }
                            } else {
                                $("#no-annonces-message");
                            }
                        },
                        error: function(jqXHR, textStatus, errorThrown) {
                            console.error("Erreur lors de la requête AJAX : ", textStatus, errorThrown);
                        }
                    });
                });
            </script>
            <!-- <p id="no-annonces-message">Vous n'avez pas posté d'annonces.</p> -->
            <div class="button-container">
                <button class="add-plant" type="submit">AJOUTER UNE ANNONCE</button>
            </div>
        </div>
    </section>
    <footer class="footer">
        <p>© 2024 Tous droits réservés.</p>
        <a href="https://www.instagram.com/arosajeprojet/" target="_blank">Contactez-nous sur Instagram <i class="fab fa-instagram"></i></a>
    </footer>
    <div id="addAnnonceModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Ajouter une annonce</h2>
            <form id="addAnnonceForm">
                <div class="form-group">
                    <label for="plantName">Nom de la plante* :</label>
                    <input type="text" id="plantName" name="plantName" required>
                </div>
                <div class="form-group">
                    <label for="plantImage">Photo de la plante* :</label>
                    <input type="file" id="plantImage" name="plantImage" accept="image/png, image/jpeg" required>
                </div>
                <div class="form-group">
                    <label for="ownerAddress">Adresse* :</label>
                    <input type="text" id="ownerAddress" name="ownerAddress" required>
                </div>
                <div class="form-group">
                    <label for="ownerCity">Ville* :</label>
                    <input type="text" id="ownerCity" name="ownerCity" required>
                </div>
                <div class="form-group form-group-inline">
                    <div class="form-group-half">
                        <label for="ownerPostalCode">Code postal* :</label>
                        <input type="text" id="ownerPostalCode" name="ownerPostalCode" required>
                    </div>
                    <div class="form-group-half">
                        <label for="ownerCountry">Pays* :</label>
                        <select id="ownerCountry" name="ownerCountry" required></select>
                    </div>
                </div>
                <i>*Champs requis</i>
                <button type="submit" id="addAnnonceSubmit" disabled>AJOUTER</button>
            </form>
        </div>
    </div>
    <div id="logoutModal" class="modal">
        <div class="decoModal-content">
            <p>Voulez-vous vraiment vous déconnecter ?</p>
            <div class="modal-buttons">
                <button id="logoutConfirm">OUI</button>
                <button id="logoutCancel">NON</button>
            </div>
        </div>
    </div>
    <script src="account.js"></script>
    <script src="../logout.js"></script>
</body>
</html>
